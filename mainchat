-- Função para carregar o hub
local function loadBananaHub()
    local BananaLib = loadstring(game:HttpGet(('https://raw.githubusercontent.com/Banana2416fjoe/bananahub/main/source')))()
    _G.BananaLib = BananaLib -- Salva a instância para acesso posterior

    local Player = game.Players.LocalPlayer
    local Window = BananaLib:MakeWindow({Name = "Banana Hub", HidePremium = false, SaveConfig = true, ConfigFolder = "BananaHub", IntroText = "Loading...", IntroIcon = "rbxassetid://7734058345" })

    -- Tab Main
    local Tab = Window:MakeTab({ Name = "Main", Icon = "rbxassetid://7733960981", PremiumOnly = false })
    local Section = Tab:AddSection({ Name = "Main Section" })
    Tab:AddButton({ Name = "Rejoin Server", Callback = function()
        local ts = game:GetService("TeleportService")
        local p = game:GetService("Players").LocalPlayer
        ts:Teleport(game.PlaceId, p)
    end })
    Tab:AddButton({ Name = "Unc Test", Callback = function()
        loadstring(game:HttpGet("https://github.com/ltseverydayyou/uuuuuuu/blob/main/UNC%20test?raw=true"))()
    end })
    Tab:AddButton({ Name = "Kick Self", Callback = function()
        game.Players.LocalPlayer:Kick("You Have Been Kicked")
    end })
    Tab:AddButton({ Name = "Destroy Banana Hub", Callback = function()
        _G.BananaHubLoaded = false  -- Marca que o Banana Hub não está mais carregado
        BananaLib:Destroy()
        BananaLib:MakeNotification({ Name = "Banana Hub", Content = "Banana Hub Destroyed", Image = "rbxassetid://4483345998", Time = 5 })
    end })

    -- Tab Anime Dimensions
    local Tab = Window:MakeTab({ Name = "Anime Dimensions", Icon = "rbxassetid://7733799901", PremiumOnly = false })
    local Section = Tab:AddSection({ Name = "Scripts" })
    Tab:AddButton({ Name = "Script CrazyDay", Callback = function()
        loadstring(game:HttpGet('https://raw.githubusercontent.com/CanisLupusXL/CanislupusXHub/main/Anime_Dimension_Simulator'))()
    end })

    -- Tab Blox Fruits
    local Tab = Window:MakeTab({ Name = "Blox Fruits", Icon = "rbxassetid://7733799901", PremiumOnly = false })
    local Section = Tab:AddSection({ Name = "Farm" })
    BananaLib:MakeNotification({ Name = "Banana Hub", Content = "Banana Hub Loaded", Image = "rbxassetid://4483345998", Time = 5 })
    Tab:AddButton({ Name = "Auto Chest", Callback = function()
        _G.JoinTeam = "Marines"
        _G.Stop_If_Has_Items = true
        loadstring(game:HttpGet("https://github.com/PNguyen0199/Script/raw/main/Trash_Auto_Chest.lua"))()
    end })
    Tab:AddButton({ Name = "Ninja Hub Azure", Callback = function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/Xero2409/NinjaHub/main/ninjahub.lua"))()
    end })
    Tab:AddButton({ Name = "Ninja Hub Hoho", Callback = function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/acsu123/NinjaHub/main/LoaderBloxFruit.lua"))()
    end })
    Tab:AddButton({ Name = "W-Azure V2", Callback = function() 
        getgenv().Team = "Marines"
        getgenv().AutoLoad = true
        getgenv().SlowLoadUi = false
        getgenv().ForceUseSilentAimDashModifier = false
        getgenv().ForceUseWalkSpeedModifier = false
        loadstring(game:HttpGet("https://api.luarmor.net/files/v3/loaders/3b2169cf53bc6104dabe8e19562e5cc2.lua"))()
    end })

    -- Tab Murder Mystery 2
    local Tab = Window:MakeTab({ Name = "Murder Mystery 2", Icon = "rbxassetid://7733799901", PremiumOnly = false })
    local Section = Tab:AddSection({ Name = "Scripts" })
    Tab:AddButton({ Name = "Symphony Hub", Callback = function()
        loadstring(game:HttpGet('https://raw.githubusercontent.com/ThatSick/ArrayField/main/SymphonyHub.lua'))()
    end })

    -- Tab Skywars/Bedwars
    local Tab = Window:MakeTab({ Name = "Skywars/Bedwars", Icon = "rbxassetid://7733799901", PremiumOnly = false })
    local Section = Tab:AddSection({ Name = "Scripts" })
    Tab:AddButton({ Name = "Vape V4", Callback = function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/7GrandDadPGN/VapeV4ForRoblox/main/NewMainScript.lua", true))()
    end })
    Tab:AddButton({ Name = "Nexus", Callback = function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/s-o-a-b/nexus/main/loadstring"))()
    end })

    -- Tab Universal
    local Tab = Window:MakeTab({ Name = "Universal", Icon = "rbxassetid://7733799901", PremiumOnly = false })
    local Section = Tab:AddSection({ Name = "Admin" })
    Tab:AddButton({ Name = "Infinite Yield Reborn", Callback = function()
        loadstring(game:HttpGet("https://github.com/fuckusfm/infiniteyield-reborn/raw/master/source"))()
    end })
    local Section = Tab:AddSection({ Name = "Player" })
    Tab:AddButton({ Name = "Fly V3", Callback = function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/XNEOFF/FlyGuiV3/main/FlyGuiV3.txt"))()
    end })
    Tab:AddButton({ Name = "Npc Hitbox Expander", Callback = function()
        loadstring(game:HttpGet("https://hastebin.skyra.pw/raw/zayajuquva"))()
    end })
    Tab:AddButton({ Name = "OP Fling", Callback = function()
        loadstring(game:HttpGet(('https://raw.githubusercontent.com/0Ben1/fe/main/obf_rf6iQURzu1fqrytcnLBAvW34C9N55kS9g9G3CKz086rC47M6632sEd4ZZYB0AYgV.lua.txt'),true))()
    end })
    local Section = Tab:AddSection({ Name = "Others" })
    Tab:AddButton({ Name = "Keyboard", Callback = function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/GGH52lan/GGH52lan/main/keyboard.txt"))()
    end })
    Tab:AddButton({ Name = "NukeVsCity", Callback = function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/NukeVsCity/TheALLHACKLoader/main/NukeLoader", true))()
    end })
    Tab:AddButton({ Name = "Index Hub 300+ Scripts", Callback = function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/IndexZHub/Loader/main/Loader"))()
    end })
    Tab:AddButton({ Name = "VexHub", Callback = function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/V31nc/On-Discord/Created/VexHub"))()
    end })
    Tab:AddButton({ Name = "Universal Hub FE", Callback = function()
        loadstring(game:HttpGet('https://raw.githubusercontent.com/Dvrknvss/UniversalFEScriptHub/main/Script'))()
    end })

    -- Exibindo notificação de que o Banana Hub foi carregado
    BananaLib:MakeNotification({ Name = "Banana Hub", Content = "Banana Hub Loaded", Image = "rbxassetid://4483345998", Time = 5 })
end

-- Função para verificar se o Banana Hub foi destruído
local function checkIfBananaHubDestroyed()
    if _G.BananaLib then
        -- Verifica se a instância BananaLib está válida
        local success, _ = pcall(function()
            _G.BananaLib:MakeNotification({ Name = "Banana Hub", Content = "Checking if Banana Hub is destroyed...", Image = "rbxassetid://4483345998", Time = 5 })
        end)
        if not success then
            -- Se não foi possível executar a função, considera que o Banana Hub foi destruído
            _G.BananaLib = nil
            _G.BananaHubLoaded = false
            warn("Banana Hub instance is no longer valid. Cleaning up...")
            destroyButton()
        end
    end
end

-- Função para destruir o botão e o ScreenGui do Banana Hub
local function destroyButton()
    local gui = game.CoreGui:FindFirstChild("MyScreenGui")
    if gui then
        gui:Destroy()
        _G.MyImageButtonActive = false
        warn("Removed Banana Hub button and ScreenGui.")
    else
        warn("Banana Hub button and ScreenGui not found.")
    end
end

-- Verifica periodicamente se o Banana Hub foi destruído e remove o botão correspondente
spawn(function()
    while true do
        wait(10)  -- Intervalo de verificação em segundos (ajuste conforme necessário)
        checkIfBananaHubDestroyed()
    end
end)

-- Verifica se o Banana Hub já foi carregado antes de tentar carregar novamente
if not _G.BananaLib then
    -- Se não foi carregado, carrega o Banana Hub
    loadBananaHub()
else
    -- Se já foi carregado, exibe a notificação de que está carregado
    local BananaLib = _G.BananaLib
    if BananaLib then
        BananaLib:MakeNotification({ Name = "Banana Hub", Content = "Banana Hub is already loaded", Image = "rbxassetid://4483345998", Time = 5 })
    end
end
